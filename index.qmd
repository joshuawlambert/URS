---
title: "Shiny for Python with WebAssembly"
format: 
  html:
    theme: cosmo
    css: styles.css
filters:
  - shinylive
---

```{shinylive-python}
#| standalone: true

from shiny import App, render, ui
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

app_ui = ui.page_fluid(
    ui.h2("Interactive Data Analysis"),
    ui.layout_sidebar(
        sidebar=ui.sidebar(
            ui.input_slider("n", "Number of points", 10, 100, 50),
            ui.input_select(
                "dist", 
                "Distribution",
                {"norm": "Normal", "unif": "Uniform", "exp": "Exponential"}
            )
        ),
        main=ui.output_plot("histogram"),
    ),
    ui.output_table("summary")
)

def server(input, output, session):
    @output
    @render.plot
    def histogram():
        n = input.n()
        if input.dist() == "norm":
            data = np.random.normal(0, 1, n)
        elif input.dist() == "unif":
            data = np.random.uniform(-3, 3, n)
        else:
            data = np.random.exponential(1, n)
            
        plt.figure()
        plt.hist(data, bins=20)
        plt.title(f"{input.dist()} Distribution")
        return plt
    
    @output
    @render.table
    def summary():
        n = input.n()
        if input.dist() == "norm":
            data = np.random.normal(0, 1, n)
        elif input.dist() == "unif":
            data = np.random.uniform(-3, 3, n)
        else:
            data = np.random.exponential(1, n)
            
        return pd.DataFrame({
            'Statistic': ['Mean', 'Std Dev', 'Min', 'Max'],
            'Value': [
                np.mean(data),
                np.std(data),
                np.min(data),
                np.max(data)
            ]
        })

app = App(app_ui, server)
```